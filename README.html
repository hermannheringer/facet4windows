<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>readme</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="README_files/libs/clipboard/clipboard.min.js"></script>
<script src="README_files/libs/quarto-html/quarto.js"></script>
<script src="README_files/libs/quarto-html/popper.min.js"></script>
<script src="README_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="README_files/libs/quarto-html/anchor.min.js"></script>
<link href="README_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="README_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="README_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="README_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="README_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<p><img src="README/logo.png" class="img-fluid" alt="logo.png"> # FACET4 WINDOWS 10/11</p>
<ul>
<li><a href="#description"><strong>Description</strong></a></li>
<li><a href="#before-you-run"><strong>Before you run!</strong></a></li>
<li><a href="#liability"><strong>Liability</strong></a></li>
<li><a href="#execution"><strong>Execution</strong></a></li>
<li><a href="#interactivity"><strong>Interactivity</strong></a></li>
<li><a href="#compatibility"><strong>Compatibility</strong></a></li>
<li><a href="#known-side-effects"><strong>Known side effects</strong></a></li>
<li><a href="#known-issues"><strong>Known issues</strong></a></li>
<li><a href="#undo-changes"><strong>Undo changes</strong></a></li>
<li><a href="#final-considerations"><strong>Final considerations</strong></a></li>
<li><a href="#thanks-to"><strong>Thanks To</strong></a></li>
</ul>
<section id="description" class="level2">
<h2 class="anchored" data-anchor-id="description"><strong>Description</strong></h2>
<section id="another-latency-reducing-debloating-windows-ruining-script-with-thousands-of-registry-tweaks-zero-solid-foundation-and-absolutely-no-studies-like-anova-to-prove-youre-doing-better-than-the-actual-os-developers-themselves." class="level4">
<h4 class="anchored" data-anchor-id="another-latency-reducing-debloating-windows-ruining-script-with-thousands-of-registry-tweaks-zero-solid-foundation-and-absolutely-no-studies-like-anova-to-prove-youre-doing-better-than-the-actual-os-developers-themselves.">2024: Another latency-reducing, debloating, Windows-ruining script with thousands of registry tweaks, zero solid foundation, and absolutely no studies (like ANOVA) to prove you‚Äôre doing better than the actual OS developers themselves.‚Äù</h4>
</section>
<section id="reckless-nah-im-just-more-into-studying-and-removing-junk-and-noise-than-chasing-the-magic-registry-key-thatll-supposedly-turn-your-system-into-something-mind-blowing.-come-on-give-me-a-break" class="level4">
<h4 class="anchored" data-anchor-id="reckless-nah-im-just-more-into-studying-and-removing-junk-and-noise-than-chasing-the-magic-registry-key-thatll-supposedly-turn-your-system-into-something-mind-blowing.-come-on-give-me-a-break"><em>‚ÄúReckless‚Äù? Nah‚Ä¶ I‚Äôm just more into studying and removing junk and noise than chasing the ‚Äúmagic registry key‚Äù that‚Äôll supposedly turn your system into something mind-blowing. Come on, give me a break!</em></h4>
<hr>
<p>Introduction:</p>
<p>The PowerShell script presented here automates routine tasks on Windows 10 and 11 distributions (24H2 compatible), specifically focusing on improving performance and reducing overall latency for devices with limited CPU and RAM resources. While the script does not target IT administrators or serve as an <code>"anti-tracking"</code> solution, it aims to balance maintaining desired functionality and optimising system performance.</p>
<p>Approach and Scope:</p>
<p>Unlike conventional <code>"debloatware"</code> scripts available on the web, this comprehensive script encompasses various elements beyond removing unnecessary features. Acknowledging that such deletions can lighten the system, my approach combines different methodologies and best practices to explore specific areas that warrant further optimisation.</p>
<p>It is crucial to recognise the complexity and quality of the operating system developed by Microsoft and its collaborators. Attempting further optimisation without compromising essential functionality would be audacious. Therefore, my script identifies areas where functionality can be optimised to gain performance while retaining the system‚Äôs overall characteristics and ensuring broad compatibility.</p>
<p>Respecting Official Distributions:</p>
<p>My philosophy does not endorse creating a barebones and featureless system through code. Suspicious distributions like <code>"ATLAS"</code> or <code>"TINY 11"</code> are not recommended, despite acknowledging the developers‚Äô efforts. Instead, I emphasise relying on official distributions designed to meet most users‚Äô requirements.</p>
<p>Challenges and Best Practices:</p>
<p>While tools like <code>"NTlite"</code> can help test scripts for optimisation purposes, I must approach this task with the utmost respect for the system‚Äôs developers and a deep understanding of its nuances. Disabling features or altering kernel behaviour without comprehensive knowledge can lead to adverse effects. Thoroughly filtering through official documentation, addressing misconceptions, and distinguishing signal from noise can be time-consuming, yet essential.</p>
<p>Windows Services Optimisation:</p>
<p>Based on my experience, extensive optimisation of Windows Services proved to be a fruitless endeavour. Accepting the system as it is maybe the wiser choice for most scenarios. However, individuals seeking further customisation may explore options involving low-level programming languages and kernel customisations.</p>
</section>
<section id="fresh-installation-of-windows-ltsc-21h2-with-all-drivers-and-updates-installed-after-applying-this-script" class="level4">
<h4 class="anchored" data-anchor-id="fresh-installation-of-windows-ltsc-21h2-with-all-drivers-and-updates-installed-after-applying-this-script">Fresh installation of Windows LTSC 21H2 with all drivers and updates installed after applying this script :</h4>
<p>CPU:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="README/cpu.png" class="img-fluid figure-img"></p>
<figcaption>cpu.png</figcaption>
</figure>
</div>
<p>Memory:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="README/mem.png" class="img-fluid figure-img"></p>
<figcaption>mem.png</figcaption>
</figure>
</div>
</section>
</section>
<section id="before-you-run" class="level2">
<h2 class="anchored" data-anchor-id="before-you-run"><strong>Before you run!</strong></h2>
<pre><code>‚òù Although the author has made an effort to provide broad compatibility,
    this script was conceived aiming at a clean install of Windows,
    and if you use it outside that context, some programs may stop working.
    Be aware of the risk.</code></pre>
<pre><code>üö´ Do not run this script if you are not familiar with the topic.
    Some functions may reduce security, uninstall or prevent applications from running again and disable
    some internal operating system functionalities. If you don't understand what a function does, don't run it.</code></pre>
<pre><code>üö´ Never run scripts from strangers without checking the code first!
    Research indicates that a significant 76% of ransomware attacks originate from PowerShell scripts.</code></pre>
<pre><code>üö´ This script can damage your operating system by forcing a complete reinstallation.
    It is at your discretion and risk.</code></pre>
</section>
<section id="liability" class="level2">
<h2 class="anchored" data-anchor-id="liability"><strong>Liability</strong></h2>
<p>This script has taken dozens of hours and years of experimentation on my part, self-learning, and is being shared freely for use, distribution, and study. I‚Äôm not responsible for anything. All script is provided as it is, and you can use it at your own risk.</p>
</section>
<section id="execution" class="level2">
<h2 class="anchored" data-anchor-id="execution"><strong>Execution</strong></h2>
<p>The script is divided into a module with all the functions and a preset file containing only the call of the procedures to be executed. Directly running the script.cmd file solves all these complexities for you, such as elevating privileges.</p>
<p>If you just want to run the script with the default preset, <code>download and unpack it</code> and then simply double-click on the script.cmd file and confirm the User Account Control prompt.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="README/todownload.png" class="img-fluid figure-img"></p>
<figcaption>todownload.png</figcaption>
</figure>
</div>
</section>
<section id="interactivity" class="level2">
<h2 class="anchored" data-anchor-id="interactivity"><strong>Interactivity</strong></h2>
<p>This script is designed to run without any user interaction. Modify it as you like.</p>
<section id="presets" class="level3">
<h3 class="anchored" data-anchor-id="presets">Presets</h3>
<p>The preset file is a simple list of function names which should be called. Any function which is not present or commented in a preset will not be called. Thus the corresponding function will not be applied.</p>
<p>The function name can be prefixed with an exclamation mark <code>!</code>, which will instead cause the function to be removed from the selection. This is useful when you want to apply the whole preset but omit a few specific functions in the current run.</p>
</section>
<section id="log" class="level3">
<h3 class="anchored" data-anchor-id="log">Log</h3>
<p>The script automatically stores the output of the script execution in a folder like <code>C:\Temp\facet4</code> .</p>
</section>
<section id="system-restore-point" class="level3">
<h3 class="anchored" data-anchor-id="system-restore-point">System Restore Point</h3>
<p>The script automatically tries to create a system restore point before the functions run.</p>
<p>System Restore is a feature designed to create a snapshot of the current working state and save it as a ‚Äúrestore point‚Äù when essential changes are detected on your computer. Suppose a critical issue occurs after installing an update, driver, or application or incorrectly modifying system settings in the registry, you can use a restore point to revert your laptop or desktop computer to an earlier state to resolve the issue without losing your files.</p>
</section>
</section>
<section id="compatibility" class="level2">
<h2 class="anchored" data-anchor-id="compatibility"><strong>Compatibility</strong></h2>
<p>The script was developed and tested using the latest Windows 10 and 11 Home and Pro distributions in English and Portuguese languages and aims to be fully compatible with the most up-to-date version of them, you can run the script on other distributions, but the code is still designed primarily for Home/Pro and is not compatible with versions before Windows 10.</p>
<ul class="task-list">
<li><label><input type="checkbox" checked="">Windows 10 (English/Portuguese)</label>
<ul class="task-list">
<li><label><input type="checkbox" checked="">Home</label></li>
<li><label><input type="checkbox" checked="">Pro</label></li>
</ul></li>
<li><label><input type="checkbox" checked="">Windows 11 (English/Portuguese)</label>
<ul class="task-list">
<li><label><input type="checkbox" checked="">Home</label></li>
<li><label><input type="checkbox" checked="">Pro</label></li>
</ul></li>
</ul>
</section>
<section id="known-side-effects" class="level2">
<h2 class="anchored" data-anchor-id="known-side-effects"><strong>Known side effects</strong></h2>
<ul>
<li>Some Windows settings will show the message <code>Some of these settings are hidden or managed by your organization.</code> This is due to some functions of the script that use Group Policy Objects (GPO). The exact mechanism is used in companies so that users without administrative privileges cannot change the settings. I‚Äôm using this because, in theory, it prevents future system updates from reverting these settings without notice. If you would like to make these settings available, disable the <code>DisableAppCompat</code> function in the present file before running it.</li>
<li>The script disables support for legacy 16-bit applications. If you still use any apps from the Jurassic period, disable the <code>DisableAppCompat</code> function in the present file before running it.</li>
<li>The script disables some functionality of the <code>Xbox</code> subsystem. If you use any games from your Xbox account, disable the <code>RemoveXboxFeatures</code> function in the present file before running.</li>
<li>This script automatically changes the <code>Processor performance boost mode</code> plan according to the processor brand (AMD/Intel) and computer type (Notebook/Desktop).</li>
</ul>
<p>You can easily change this option by accessing the steps below: 1. Open Command Prompt: <code>hold down the Windows Key, and Press R</code> on your keyboard. 2. Type <code>power</code> in the window and press Enter. 3. Click on the <code>Change advanced power settings</code> option and scroll down to the <code>Processor power management</code> tab. The default state is <code>Aggressive</code> . 4. Follow the on-screen options to change and click on the <code>Apply</code> button. It is not necessary to restart the device.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="README/power.png" class="img-fluid figure-img"></p>
<figcaption>power.png</figcaption>
</figure>
</div>
</section>
<section id="known-issues" class="level2">
<h2 class="anchored" data-anchor-id="known-issues"><strong>Known issues</strong></h2>
<p>When trying to change a specific key when using an Azure Active Directory account.</p>
<p>The problem is easily worked around by performing this modification manually using <code>Regedit</code>.</p>
</section>
<section id="undo-changes" class="level2">
<h2 class="anchored" data-anchor-id="undo-changes"><strong>Undo changes</strong></h2>
<section id="reverse-the-entire-script" class="level3">
<h3 class="anchored" data-anchor-id="reverse-the-entire-script">Reverse the entire script</h3>
<p>Based on my ‚Äúlimited‚Äù knowledge acquired over the years as a user, I do not believe that reversing function by function will bring your operating system to the previous state with the same behaviour in all its details. I have always witnessed several inconsistencies using this approach in addition to spending many hours trying to solve this.</p>
<p>Based on the above, I find it advisable (which is why this built-in tool exists in Windows) to perform a <strong>System Restore Point</strong> before executing this script.</p>
<p>To revert the entire script, follow these steps:</p>
<ol type="1">
<li>Open Command Prompt <code>hold down the Windows Key, and Press R</code> on your keyboard.</li>
<li>Type <code>rstrui.exe</code> in the window, and then press Enter.</li>
<li>Find a restore point with a name like <code>System Restore Point dated 00/00/0000 00:00:00 before running facet4 script</code>. It should be the newest restore point there.</li>
<li>Follow the on-screen instructions to complete the system restore.</li>
</ol>
</section>
<section id="revert-functions" class="level3">
<h3 class="anchored" data-anchor-id="revert-functions">Revert functions</h3>
<p>To undo the effects of a specific function, you can write and add a complementary function that restores the original behavior and append it to the current file.</p>
<p>The code at the end of each instruction contains the default values for Windows 11 22H2 and Windows 10 LTSC 21H2 distributions.</p>
<p>You are welcome to experiment and modify the functions as you wish.</p>
</section>
</section>
<section id="final-considerations" class="level2">
<h2 class="anchored" data-anchor-id="final-considerations"><strong>Final considerations</strong></h2>
<p>If you understand what you are doing, consider downloading and running Microsoft Autoruns to check your system.</p>
<p>This utility, which has the most comprehensive knowledge of auto-starting locations of any startup monitor, shows you what programs are configured to run during system bootup or login, and when you start various built-in Windows applications like Internet Explorer, Explorer and media players. These programs and drivers include ones in your startup folder, Run, RunOnce, and other Registry keys. Autoruns reports Explorer shell extensions, toolbars, browser helper objects, Winlogon notifications, auto-start services, and much more. Autoruns goes way beyond other autostart utilities.</p>
<p>https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="README/autoruns_v13.png" class="img-fluid figure-img"></p>
<figcaption>autoruns_v13.png</figcaption>
</figure>
</div>
<section id="after-executing-this-script-i-recommend-the-following-steps-to-achieve-an-optimized-experience.-its-advisable-to-conduct-thorough-research-before-implementing-any-changes-and-please-be-aware-that-any-alterations-are-at-your-own-risk.-the-author-cannot-be-held-accountable-for-any-issues-or-damages-that-may-arise." class="level4">
<h4 class="anchored" data-anchor-id="after-executing-this-script-i-recommend-the-following-steps-to-achieve-an-optimized-experience.-its-advisable-to-conduct-thorough-research-before-implementing-any-changes-and-please-be-aware-that-any-alterations-are-at-your-own-risk.-the-author-cannot-be-held-accountable-for-any-issues-or-damages-that-may-arise.">After executing this script, I recommend the following steps to achieve an optimized experience. It‚Äôs advisable to conduct thorough research before implementing any changes, and please be aware that any alterations are at your own risk. The author cannot be held accountable for any issues or damages that may arise.</h4>
</section>
<section id="adjust-memory-command-rate-explore-the-bios-settings-for-your-memory-and-locate-the-command-rate-or-similar-settings-such-as-nmode.-change-the-value-from-2t-to-1t.-this-adjustment-can-lead-to-a-perceptible-improved-performance." class="level4">
<h4 class="anchored" data-anchor-id="adjust-memory-command-rate-explore-the-bios-settings-for-your-memory-and-locate-the-command-rate-or-similar-settings-such-as-nmode.-change-the-value-from-2t-to-1t.-this-adjustment-can-lead-to-a-perceptible-improved-performance.">1.Adjust Memory Command Rate: Explore the BIOS settings for your memory and locate the ‚ÄúCommand Rate‚Äù or similar settings such as ‚ÄúNmode.‚Äù Change the value from 2T to 1T. This adjustment can lead to a perceptible improved performance.</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="README/CommandRate.png" class="img-fluid figure-img"></p>
<figcaption>CommandRate.png</figcaption>
</figure>
</div>
</section>
<section id="modify-ddr-power-down-mode-within-the-bios-find-settings-like-ddr-powerdown-and-idle-counter-related-to-power-management.-switch-from-auto-or-enabledbios-to-disabledpcode.-this-change-can-contribute-to-better-system-responsiveness.-reduces-in-most-cases-8-of-memory-latency." class="level4">
<h4 class="anchored" data-anchor-id="modify-ddr-power-down-mode-within-the-bios-find-settings-like-ddr-powerdown-and-idle-counter-related-to-power-management.-switch-from-auto-or-enabledbios-to-disabledpcode.-this-change-can-contribute-to-better-system-responsiveness.-reduces-in-most-cases-8-of-memory-latency.">2.Modify ‚ÄúDDR Power Down Mode‚Äù: Within the BIOS, find settings like ‚ÄúDDR PowerDown and idle counter‚Äù related to power management. Switch from ‚ÄúAuto‚Äù or ‚ÄúEnabled/BIOS‚Äù to ‚ÄúDisabled/PCODE.‚Äù This change can contribute to better system responsiveness. Reduces, in most cases, ~8% of memory latency.</h4>
</section>
<section id="enhance-gpu-performance-if-using-a-first-rate-video-card-investigate-whether-it-supports-above-4g-decoding-or-resizable-bar.-if-compatible-research-the-process-to-enable-this-feature-on-your-motherboard.-it-enhances-graphics-performance-a-lot." class="level4">
<h4 class="anchored" data-anchor-id="enhance-gpu-performance-if-using-a-first-rate-video-card-investigate-whether-it-supports-above-4g-decoding-or-resizable-bar.-if-compatible-research-the-process-to-enable-this-feature-on-your-motherboard.-it-enhances-graphics-performance-a-lot.">3.Enhance GPU Performance: If using a first-rate video card, investigate whether it supports ‚ÄúAbove 4G Decoding‚Äù or ‚ÄúResizable BAR.‚Äù If compatible, research the process to enable this feature on your motherboard. It enhances graphics performance a lot.</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="README/Above4G.png" class="img-fluid figure-img"></p>
<figcaption>Above4G.png</figcaption>
</figure>
</div>
</section>
<section id="explore-raid-configuration-for-users-with-an-amd-ryzen-platform-its-worth-exploring-the-possibility-of-utilizing-raid-0-for-sata-or-nvme-devices.-even-notebooks-with-locked-bios-and-two-nvme-ports-might-support-this-unofficially.-search-how-to-implement-this-configuration-for-improved-storage-performance.-its-pure-luxury-but-it-is-fantastic" class="level4">
<h4 class="anchored" data-anchor-id="explore-raid-configuration-for-users-with-an-amd-ryzen-platform-its-worth-exploring-the-possibility-of-utilizing-raid-0-for-sata-or-nvme-devices.-even-notebooks-with-locked-bios-and-two-nvme-ports-might-support-this-unofficially.-search-how-to-implement-this-configuration-for-improved-storage-performance.-its-pure-luxury-but-it-is-fantastic">4.Explore RAID Configuration: For users with an AMD Ryzen platform, it‚Äôs worth exploring the possibility of utilizing RAID 0 for SATA or NVMe devices. Even notebooks with locked BIOS and two NVMe ports might support this <code>unofficially</code>. Search how to implement this configuration for improved storage performance. It‚Äôs pure luxury, but it is fantastic!</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="README/Omen-Raid0.png" class="img-fluid figure-img"></p>
<figcaption>Omen-Raid0.png</figcaption>
</figure>
</div>
</section>
<section id="enable-message-signaled-interrupts.-be-aware-that-enabling-msi-for-a-driver-without-support-will-break-your-windows" class="level4">
<h4 class="anchored" data-anchor-id="enable-message-signaled-interrupts.-be-aware-that-enabling-msi-for-a-driver-without-support-will-break-your-windows">5.Enable Message Signaled Interrupts. Be aware that enabling MSI for a driver without support will break your Windows!</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="README/MSI.png" class="img-fluid figure-img"></p>
<figcaption>MSI.png</figcaption>
</figure>
</div>
</section>
<section id="and-lastly-dont-forget-if-its-a-fresh-install-of-the-operating-system-select-english-world-as-the-time-zone-it-pretty-much-solves-the-initial-bloatware-problem-on-your-new-windows.-this-does-not-apply-to-the-ltsc-or-iot-distros-as-it-already-comes-with-reduced-os-footprint.-credits-to-mastermind-thiojoe" class="level4">
<h4 class="anchored" data-anchor-id="and-lastly-dont-forget-if-its-a-fresh-install-of-the-operating-system-select-english-world-as-the-time-zone-it-pretty-much-solves-the-initial-bloatware-problem-on-your-new-windows.-this-does-not-apply-to-the-ltsc-or-iot-distros-as-it-already-comes-with-reduced-os-footprint.-credits-to-mastermind-thiojoe">6.And lastly, don‚Äôt forget, if it‚Äôs a fresh install of the operating system, select ‚ÄúEnglish (World)‚Äù as the time zone; it pretty much solves the initial bloatware problem on your new Windows. This does not apply to the LTSC or IoT distros, as it already comes with reduced OS footprint. Credits to mastermind <span class="citation" data-cites="ThioJoe">@ThioJoe</span>!</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="README/ThioJoe.png" class="img-fluid figure-img"></p>
<figcaption>ThioJoe.png</figcaption>
</figure>
</div>
</section>
<section id="following-these-guidelines-can-significantly-optimize-your-systems-performance-after-running-this-script.-remember-to-conduct-in-depth-research-and-understand-the-potential-implications-of-each-modification-before-proceeding.-your-own-discretion-and-caution-are-advised-as-the-author-takes-no-responsibility-for-any-adverse-outcomes." class="level4">
<h4 class="anchored" data-anchor-id="following-these-guidelines-can-significantly-optimize-your-systems-performance-after-running-this-script.-remember-to-conduct-in-depth-research-and-understand-the-potential-implications-of-each-modification-before-proceeding.-your-own-discretion-and-caution-are-advised-as-the-author-takes-no-responsibility-for-any-adverse-outcomes.">Following these guidelines can significantly optimize your system‚Äôs performance after running this script. Remember to conduct in-depth research and understand the potential implications of each modification before proceeding. Your own discretion and caution are advised, as the author takes no responsibility for any adverse outcomes.</h4>
</section>
</section>
<section id="thanks-to" class="level2">
<h2 class="anchored" data-anchor-id="thanks-to"><strong>Thanks To</strong></h2>
<p>The thousands of people who actively contribute to forums, websites and communities, making their knowledge available; without this, it would not be possible to waste/spend dozens of hours trying to learn things like this.</p>
<p>I leave my thanks.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>